perfeito üöÄ vou reescrever o prompt completo para o Manus AI, j√° com todos os m√≥dulos (agenda cinema, marketplace com markup, kiosk, ofertas/flash, dashboards), c√≥digos promocionais e agora o fluxo atualizado: fichas de anamnese geradas no agendamento + confirma√ß√£o autom√°tica para cliente e artista.

‚∏ª


# KRONOS SYNC ‚Äî Build Full App (Web + APIs + Seeds + Tests + UX/UI) ‚Äî Manus AI

## Miss√£o
Construir o **KRONOS SYNC** ponta a ponta, com foco em gest√£o de est√∫dios de tatuagem, integrando:
- App Web (Next.js 14 + TS, App Router)
- Backend (Prisma/PostgreSQL)
- APIs REST
- Seeds + Testes
- UX/UI responsiva (estilo KRONOS: cyber minimal dark)
- Integra√ß√µes futuras via n8n (Drive, Calendar)

---

## Stack & Infra
- **Web/Server:** Next.js 14 (App Router), TypeScript (strict)
- **DB/ORM:** PostgreSQL + Prisma
- **Infra local:** Docker (db + app)
- **Auth:** NextAuth (Google/Email link) + RBAC (`MANAGER`, `ARTIST`, `CLIENT`) ‚Äî pode ser stub no MVP
- **Observabilidade:** logs estruturados, `/metrics`
- **Integra√ß√µes (stub + hook):** Google Drive (fichas), Google Calendar (slots)
- **Mobile opcional:** Expo shell para agenda do dia + push notifications

---

## Design System (KRONOS)
- **Paleta:** fundo `#0B0B0B`, texto `#E6E6E6`, acentos `#7C3AED` (roxo), `#22D3EE` (ciano)
- **Fonte:** Inter / DM Sans (400‚Äì700)
- **Componentes:** cards 16px radius, sombras suaves, √≠cones Lucide
- **Estilo:** Dark cyber minimal ‚Äî grid limpo, anima√ß√µes ‚â§200ms
- **IA Unificada ‚Äî Diretriz:** ‚ÄúTranspar√™ncia e clareza. Agenda estilo cinema, dashboards objetivos, profissionalismo cl√≠nico.‚Äù

---

## Regras de Neg√≥cio (Core)

### Agenda
- **3 macas** com slots exibidos em grid estilo **mapa de cinema**
- Estados: `OPEN`, `HELD` (timeout 2‚Äì5min), `BOOKED`
- Anti-overbooking via transa√ß√£o (Prisma)

### Booking
- Valor m√≠nimo: **R$ 400,00**
- **Planos de artista**:
  - **GUEST:** comiss√£o fixa 30% (sem redu√ß√£o, sem marketplace)
  - **RESIDENT:** come√ßa em 30%, cai para 20% ao atingir teto estrat√©gico (configur√°vel em `.env`: ex. R$10k/m√™s ou por season)

### Fichas de Anamnese
- **Geradas no agendamento** (n√£o no dia da tattoo)
- Artista/manager gera ficha ‚Üí link salvo em `booking.fichaUrl`
- Cliente recebe link junto da confirma√ß√£o
- Cliente preenche antes da sess√£o ‚Üí status atualizado no booking
- **Proxy seguro** para abrir ficha (stub MVP + TODO audit log)

### Confirma√ß√µes
- Ap√≥s `POST /api/bookings`, enviar confirma√ß√µes para ambos:
  - **Cliente:** detalhes da sess√£o + link da ficha
  - **Artista:** detalhes + status da ficha (‚Äúaguardando preenchimento‚Äù)
- Stub: envio por e-mail/log
- Flag `confirmationSent = true`

### Marketplace
- Apenas residentes podem listar produtos
- Pre√ßo final = `basePrice * (1 + markup%)`
- Artista recebe 100% do base, markup vai para est√∫dio
- Tipos: print, digital, original, f√≠sico

### C√≥digos Promocionais
- Artista pode gerar cupons (`PERCENT` ou `FIXED`)
- Aplic√°veis no booking (sess√£o) e no marketplace
- Clientes podem resgatar cupons no **kiosk**
- Manager v√™ relat√≥rio de uso/performance dos cupons

### Ofertas & Flash Days
- P√°gina p√∫blica com campanhas
- Clientes e n√£o-clientes podem assinar notifica√ß√µes
- Notifica√ß√µes enviadas via stub (email/log)

### Kiosk (Totem f√≠sico)
- Fullscreen (tablet/totem)
- Fluxos principais:
  - Cadastro de clientes
  - Cadastro de acompanhantes
  - Resgate de c√≥digos promocionais
- Estilo minimal ‚Üí inputs grandes, bot√µes claros, acessibilidade

---

## UX & UI

### Agenda
- Grid horizontal (3 colunas = macas)
- Cores: verde (OPEN), amarelo (HELD), roxo (BOOKED)
- Hover ‚Üí detalhes slot
- Clique ‚Üí modal booking + preview split (est√∫dio vs artista) + campo cupom

### Booking Modal
- Inputs: artista, cliente, slot, valor, cupom (opcional)
- Preview: total bruto, desconto aplicado, split (est√∫dio/artista)
- Bot√£o confirmar ‚Üí salva booking, envia confirma√ß√µes, gera ficha

### Marketplace
- Grade de cards (imagem, t√≠tulo, artista, pre√ßo final)
- Bot√£o ‚ÄúAdicionar ao Carrinho‚Äù
- Checkout com campo de cupom

### Dashboards
- **Artista:** ganhos mensais, barra de progresso at√© teto, lista de sess√µes do dia, status fichas, cupons ativos
- **Manager:** ocupa√ß√£o geral, receita bruta vs est√∫dio, marketplace KPIs, performance dos cupons, status de fichas pendentes

### Kiosk
- Fullscreen
- Bot√µes grandes: ‚ÄúCadastrar Cliente‚Äù, ‚ÄúCadastrar Acompanhante‚Äù, ‚ÄúResgatar Cupom‚Äù
- Resgate ‚Üí exibe QR/c√≥digo atrelado ao artista
- Estilo minimal (fundo preto, bot√µes neon)

---

## APIs

### Bookings
- `POST /api/bookings` ‚Üí cria booking, aplica cupom, split comiss√£o, gera ficha, envia confirma√ß√µes
- `PATCH /api/bookings/:id/status`
- `POST /api/bookings/:id/ficha` ‚Üí for√ßa gera√ß√£o de ficha
- `PATCH /api/bookings/:id/fichaUrl` ‚Üí hook do n8n/Drive
- `GET /api/bookings?artistId&status&page`

### Coupons
- `POST /api/coupons` (ARTIST)
- `GET /api/coupons/validate?code&artistId`
- `PATCH /api/coupons/:id/deactivate`
- `GET /api/coupons/artist/:id`
- `GET /api/admin/coupons/summary`

### Marketplace
- `GET /api/store/products`
- `POST /api/store/products` (ARTIST = RESIDENT)
- `POST /api/store/cart/checkout`
- `POST /api/store/orders/:id/confirm`

### Offers
- `GET /api/offers`
- `POST /api/subscribe`
- `POST /api/notify/flash` (MANAGER)

### Kiosk
- `POST /api/kiosk/signup` (novo cliente)
- `POST /api/kiosk/companion` (acompanhante)
- `POST /api/kiosk/coupon` (resgatar cupom)

### Fichas
- `GET /fichas/[bookingId]/proxy` (proxy seguro)
- `POST /api/hooks/drive/ficha-link` (hook atualiza URL)

### Dashboards
- `GET /api/me/summary` (ARTIST)
- `GET /api/admin/summary` (MANAGER)

---

## Seeds
- 1 manager, 1 residente (com produtos e cupons), 1 guest
- 12 slots (3 macas √ó 4 hor√°rios)
- 3 clientes demo
- 2 bookings demo (1 com ficha pendente, 1 com ficha preenchida)

---

## Testes
- Unit√°rios: comiss√£o, cupons, markup, ficha no booking
- Integra√ß√£o: anti-overbooking, cupom aplicado corretamente, confirma√ß√£o enviada
- E2E: fluxo kiosk ‚Üí cadastro ‚Üí resgate cupom ‚Üí booking com desconto ‚Üí gera√ß√£o ficha ‚Üí preenchimento ‚Üí proxy

---

## Crit√©rios de Aceite
- Agenda cinema operante
- Booking com split e valor m√≠nimo validados
- Fichas geradas no agendamento, link salvo, status controlado
- Confirma√ß√£o enviada para cliente e artista
- Cupons ativos, validados e aplicados
- Marketplace com markup funcionando
- Dashboards exibem dados reais
- UX/UI dark cyber minimal aplicada


‚∏ª

‚ö° esse prompt j√° est√° pronto para ser usado no Manus AI, cobrindo toda a l√≥gica de neg√≥cio, UX, APIs e integra√ß√µes.

quer que eu tamb√©m prepare uma vers√£o reduzida (2 p√°ginas) s√≥ com contratos de API e fluxos principais, para que o Manus construa mais r√°pido a base do app?
